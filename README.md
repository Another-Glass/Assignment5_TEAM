<div align="center">

# 원티드 백엔드 프리온보딩 5차 과제 - 휴먼스케이프

  <img height="400" width="700" src="https://user-images.githubusercontent.com/59385491/139865333-05dabf0a-e283-4e51-94d9-8a42e6acbb7b.jpeg">

  <h2> 👨‍💻 원티드 프리온보딩 어나더글라스 팀입니다. </h2>

<p>6명의 안경잡이 개발자들의 시선과 관점이 담긴 과제입니다.</p>
<p>무던히 포기하지 않고 견디고 견뎠던 그 시간들이 변함없는 단 하나의 해답임을 믿습니다.</p>

</div>

<div align=center>

<img alt="PRs Welcome" src="https://img.shields.io/badge/PRs-welcome-brightgreen.svg?style=flat-square" />
<img alt="Hits" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fgithub.com%2FAnother-Glass%2FAssignment1_Team1%2Fblob%2Fdevelop%2FREADME.md&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false" />
<img alt="issues" src="https://img.shields.io/github/issues/Another-Glass/Assignment1_Team1" />

</div>

</br>
</br>
</br>
</br>
</br>
</br>

## 🎤 소개

이 레포지토리는 [원티드 프리온보딩 백엔드 코스](https://www.wanted.co.kr/events/pre_onboarding_course_4) 5차 과제를 위해 만들어졌습니다.

- 일정 : 2021년 11월 15일(월) 오후 5시 ~ 11월 17일(수) 오전 10시

<br>
<br>

<div align='center'>

## 🧑🏻‍💻 팀원 소개

|                                                         **팀장 박상수**                                                         |                                                 **팀원 김성연**                                                 |                                                **팀원 최준호**                                                 |
| :-----------------------------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------: | :------------------------------------------------------------------------------------------------------------: |
|                      <img src="https://avatars.githubusercontent.com/u/59385491?v=4" height=200 width=200>                      |              <img src="https://avatars.githubusercontent.com/u/38933716?v=4" height=200 width=200>              |             <img src="https://avatars.githubusercontent.com/u/67402180?v=4" height=200 width=200>              |
| **blog**: [Plus Ultra](https://overcome-the-limits.tistory.com/) </br> **github**: [epitone](https://github.com/epitoneproject) | **blog**: [sudocorp](https://sudocorp.tistory.com/) </br> **github**: [SibaDoge1](https://github.com/SibaDoge1) | **blog**: [raejun92.log](https://velog.io/@raejun92) </br> **github**: [raejun92](https://github.com/raejun92) |
|                                 ![sprint4](https://img.shields.io/badge/wanted-sprint5-purple)                                  |                         ![sprint4](https://img.shields.io/badge/wanted-sprint5-purple)                          |                         ![sprint4](https://img.shields.io/badge/wanted-sprint5-purple)                         |
|                                                     상세, 리스트, 검색 API                                                      |                                         batch task, 유닛테스트 / DevOps                                         |                                             상세, 리스트, 검색 API                                             |
|                                                        [프로젝트 회고]()                                                        |                                 [프로젝트 회고](https://sudocorp.tistory.com/6)                                 |                                               [프로젝트 회고]()                                                |

<br>
<br>

|                                               **팀원 어유선**                                                |                                                                                                             **팀원 김현길**                                                                                                             |                                                                            **팀원 이동훈**                                                                            |
| :----------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
|            <img src="https://avatars.githubusercontent.com/u/32833404?v=4" height=200 width=200>             |                                                                          <img src="https://avatars.githubusercontent.com/u/48472537?v=4" height=200 width=200>                                                                          |                                         <img src="https://avatars.githubusercontent.com/u/68373235?v=4" height=200 width=200>                                         |
| **blog**: [Makkiato](https://makkiato.tistory.com) </br> **github**: [Makkiato](https://github.com/Makkiato) |                                                            **blog**: [gusrlf14](https://velog.io/@gusrlf14) </br> **github**: [hyunghilkim](https://github.com/hyunghilkim)                                                             |                          **blog**: [dongjay00.log](https://velog.io/@dongjay00) </br> **github**: [dongjay00](https://github.com/dongjay00)                           |
|                        ![sprint4](https://img.shields.io/badge/wanted-sprint5-purple)                        |                                                                                     ![sprint4](https://img.shields.io/badge/wanted-sprint5-purple)                                                                                      |                                                    ![sprint4](https://img.shields.io/badge/wanted-sprint5-purple)                                                     |
|                                            상세, 리스트, 검색 API                                            |                                                                                                               batch task                                                                                                                |                                                                              batch task                                                                               |
|                               [프로젝트 회고](https://makkiato.tistory.com/9)                                | [프로젝트 회고](https://velog.io/@gusrlf14/%EC%9B%90%ED%8B%B0%EB%93%9C-%EC%9C%84%EC%BD%94%EB%93%9C-%ED%94%84%EB%A6%AC%EC%98%A8%EB%B3%B4%EB%94%A9-%EB%B0%B1%EC%97%94%EB%93%9C-5%ED%9A%8C%EC%B0%A8-%EA%B3%BC%EC%A0%9C-%ED%9A%8C%EA%B3%A0) | [프로젝트 회고](https://velog.io/@dongjay00/%ED%94%84%EB%A6%AC%EC%98%A8%EB%B3%B4%EB%94%A9-%EB%8B%A4%EC%84%AF%EB%B2%88%EC%A7%B8-%EA%B3%BC%EC%A0%9C-%ED%9A%8C%EA%B3%A0) |

</div>

<br>
<br>

## 📕 과제 내용

### [필수 포함 사항]

- READ.ME 작성
  - 프로젝트 빌드, 자세한 실행 방법 명시
  - 구현 방법과 이유에 대한 간략한 설명
  - 완료된 시스템이 배포된 서버의 주소
  - Swagger나 Postman을 통한 API 테스트할때 필요한 상세 방법
  - 해당 과제를 진행하면서 회고 내용 블로그 포스팅
- Swagger나 Postman을 이용하여 API 테스트 가능하도록 구현

</br>

<details><summary>[고려 사항 및 상세설명]</summary>

<div>

### [확인 사항]

- **ORM 사용 필수**
- **데이터베이스는 SQLite로 구현**
- **secret key, api key 등을 레포지토리에 올리지 않도록 유의**
  - README.md 에 관련 설명 명시 필요

### [도전 과제: 스스로에게도 도움이 되는 내용 + 추가 가산점]

- 배포하여 웹에서 사용 할 수 있도록 제공
- 임상정보 검색 API 제공

### [과제 안내]

다음 사항들을 충족하는 서비스를 구현해주세요.

- 임상정보를 수집하는 batch task
- 수집한 임상정보에 대한 API
  - 특정 임상정보 읽기(키 값은 자유)
- 수집한 임상정보 리스트 API
  - 최근 일주일내에 업데이트(변경사항이 있는) 된 임상정보 리스트
    - pagination 기능
- **Test 구현시 가산점이 있습니다.**

</div>
</details>

</br>
</br>

## 📕 작업 효율 개선 방안

- Node.js, express, Sequelize, sqlLite를 이용해 임상정보 BatchTask 및 검색, 조회, 상세조회 api 를 구현하였습니다.
- 코드 컨벤션, 커밋 컨벤션, Git Flow를 지켜가며 작업했습니다.
- Github Project, 마일스톤을 활용해서 백로그, 이슈 관리를 진행했습니다.
- 계층 분리를 통해 코드의 가독성을 높였습니다.
- 리팩토링을 통해 가독성을 높이고, 유지보수를 편하게 하기 위해 노력 했습니다.

</br>
</br>

## 💡 구현 기능

### [ 임상정보 수집 BatchTask ]

- node-cron을 이용하여 주기적으로 openApi로부터 데이터를 받아옵니다.
- 기존 데이터에서 업데이트 될 경우를 고려하여, 데이터의 해시값을 설정하고 비교하여 변경사항이 있는지 파악했습니다.

<br>

### [ 임상정보 조회, 검색 API ]

- Pagination기능을 구현 하였습니다.
- 카테고리별(과제명, 연구종류, 진료과) 검색 기능을 구현 하였습니다.
- 최근 일주일내에 업데이트된 임상정보 리스트를 가져오게 구현 하였습니다.

<br>

### [ 에러 핸들링 ]

- 자바스크립트 자체 내장 Error 클래스를 상속 받아서, 커스텀 에러를 생성해서 관리했습니다.

<br>

### [ 유닛 테스트 ]

- 명시한 api들의 경우 Postman Test기능을 이용한 유닛테스트를 구현했습니다.
- 임상정보 수집 BatchTask의 경우 스케쥴을 이용하기 때문에 jest를 이용하여 테스트를 구현했습니다.

<br>
<br>

## ➕ 협업을 위한 노력

- 구성원들이 함께 Notion을 통해 API 명세와 DB모델을 구축 하였습니다.
- 음성대화로 소통하여, 신속하게 문제를 인식하고, 신속하게 해결 하기 위해 노력 하였습니다.
- 전체 작업을 도메인 단위로 분리하여 구성원 간의 병목현상을 줄였습니다.

</br>
</br>

## 🛠 실행 방법

- 레포지토리를 clone 받거나, 압축을 해제한 후 npm install을 통해 환경 셋팅을 진행합니다.
- npm start를 통해 서버를 구동합니다.
- src 폴더에 .env 파일을 설정해서, 환경변수를 설정합니다.
- npm start로 서버를 구동시키고, npm test를 입력하면 단위 테스트가 가능합니다.
- [.env설정 노션 링크](https://www.notion.so/pre-onboarding15/2835fc7401c74e7fa9b352dc0fe52047)

  - <details><summary><b>링크 접속불가 시 .env 파일 설정 방법</b></summary>

    ```
    PORT= '서버의 포트'
    ADMIN_USER="test@naver.com"
    ADMIN_PASSWORD="1234"
    HOST="http://localhost:4000"
    IS_SQLLITE=true
    OPEN_API_SECRET="OpenApi키"
    ```

</details>

</br>
</br>

## 🗂 과제 확인 및 평가 API 명세서

- Postman을 활용하여 API 작동 테스트를 진행했습니다.
- **배포된 서버 주소** 및 자세한 API 명세는 아래에서 확인 가능합니다.
- [🗂 API Description Link](https://documenter.getpostman.com/view/18068137/UVC8C5cm)
- [![Run in Postman](https://run.pstmn.io/button.svg)](https://documenter.getpostman.com/view/18068137/UVC8C5cm) 을 클릭하여 웹브라우저 혹은 Postman 클라이언트에 콜렉션이 로드되면

  1.  Variables 탭에서 서버 Host와 Port를 지정합니다. (기본값이 지정되어 있습니다.)
  2.  그후 우측 상단의 Run 버튼을 눌러 RUN ORDER 화면에 진입한 뒤 Run \[Collection Name\]을 클릭하면, 이상적인 상황에서의 테스트가 진행됩니다.
  3.  좌측의 Workspace 화면에서 해당 콜렉션과 그 요청에는 여러 이상적이지 않은 상황의 테스트에 대한 예시가 있습니다.

  </br>

- 임상정보 수집 BatchTask의 경우 스케쥴을 이용하기 때문에 jest를 이용한 테스트를 구현했습니다.
  - src 폴더 내에서 **npm run test**를 입력하여 확인 가능합니다.

</br>
</br>

## 😎 컨벤션 설정

- [👏🏻 협업을 위한 코드 컨벤션 설정하기](https://overcome-the-limits.tistory.com/entry/%ED%98%91%EC%97%85-%ED%98%91%EC%97%85%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%BD%94%EB%93%9C-%EC%BB%A8%EB%B2%A4%EC%85%98-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0)

- [👏🏻 Prettier, ESLint, Airbnb Style Guide로 코드 컨벤션 설정하기](https://overcome-the-limits.tistory.com/entry/%ED%98%91%EC%97%85-ESLint-Prettier-Airbnb-Style-Guide%EB%A1%9C-%EC%BD%94%EB%93%9C-%EC%BB%A8%EB%B2%A4%EC%85%98-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0?category=911197)

- [👏🏻 협업을 위한 git 커밋 컨벤션 설정하기](https://overcome-the-limits.tistory.com/entry/%ED%98%91%EC%97%85-%ED%98%91%EC%97%85%EC%9D%84-%EC%9C%84%ED%95%9C-%EA%B8%B0%EB%B3%B8%EC%A0%81%EC%9D%B8-git-%EC%BB%A4%EB%B0%8B%EC%BB%A8%EB%B2%A4%EC%85%98-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0?category=911197)

- [👏🏻 협업을 위한 Git Flow 설정하기](https://overcome-the-limits.tistory.com/entry/%ED%98%91%EC%97%85-%ED%98%91%EC%97%85%EC%9D%84-%EC%9C%84%ED%95%9C-Git-Flow-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0?category=911197)

- [👏🏻 협업을 위한 Git 명령어 가이드](https://overcome-the-limits.tistory.com/entry/%ED%98%91%EC%97%85-%ED%98%91%EC%97%85%EC%9D%84-%EC%9C%84%ED%95%9C-Git-%EB%AA%85%EB%A0%B9%EC%96%B4-%EA%B0%80%EC%9D%B4%EB%93%9C?category=911197)

</br>
</br>

## 🛠 Dependencies

</br>

<div align=center>
<img src="https://user-images.githubusercontent.com/68373235/141799640-24e33468-b3a7-4226-9598-a04a3313976d.JPG" height=850>
</div>

</br>
</br>

## 🌲 File Tree

</br>

```

📦src
 ┣ 📂bin
 ┃ ┗ 📜www.js
 ┃
 ┣ 📂configs
 ┃ ┣ 📜db.js
 ┃ ┣ 📜index.js
 ┃ ┗ 📜secretKey.js
 ┃
 ┣ 📂controllers
 ┃ ┗ 📜trialController.js
 ┃
 ┣ 📂globals
 ┃ ┣ 📜index.js
 ┃ ┣ 📜responseMessage.js
 ┃ ┣ 📜routes.js
 ┃ ┗ 📜statusCode.js
 ┃
 ┣ 📂jobs
 ┃ ┗ 📜openApiJobs.js
 ┃
 ┣ 📂models
 ┃ ┣ 📜index.js
 ┃ ┗ 📜trial.js
 ┃
 ┣ 📂routes
 ┃ ┣ 📜globalRouter.js
 ┃ ┣ 📜index.js
 ┃ ┗ 📜trialRouter.js
 ┃
 ┣ 📂services
 ┃ ┗ 📜trialService.js
 ┃
 ┣ 📂test
 ┃ ┣ 📂data
 ┃ ┃ ┗ 📜openApiTestConfig.json
 ┃ ┗ 📂unit
 ┃   ┗ 📂jobs
 ┃     ┗ 📜openApiJobs.test.js
 ┃
 ┣ 📂utils
 ┃ ┣ 📂errors
 ┃ ┃ ┣ 📜commonError.js
 ┃ ┃ ┣ 📜errors.js
 ┃ ┣ 📜index.js
 ┃ ┣ 📜logger.js
 ┃ ┗ 📜resFormatter.js
 ┣ 📜.env
 ┣ 📜.eslintrc.json
 ┣ 📜.gitignore
 ┣ 📜.prettierrc.json
 ┣ 📜app.js
 ┣ 📜database.db
 ┣ 📜package-lock.json
 ┗ 📜package.json

```
